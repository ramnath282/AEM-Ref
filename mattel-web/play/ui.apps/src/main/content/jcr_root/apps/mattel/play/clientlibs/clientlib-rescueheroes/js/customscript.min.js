
function createCookie(e,t,n){if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var i="; expires="+o.toGMTString()}else i="";document.cookie=e+"="+t+i+"; path=/"}function readCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function eraseCookie(e){createCookie(e,"",-1)}

var device,locale = $("#formLocale").val();


function reposition() {
    var e = $(this),
        t = e.find(".modal-dialog");
    e.css("display", "block"), t.css("margin-top", Math.max(0, ($(window).height() - t.height()) / 2))
}

function deviceType() {
    Modernizr.mq("all and (max-width: 640px)") ? (device = "mobile", window.fp.device = "mobile") : Modernizr.mq("all and (max-width: 1023px) and (min-width: 641px)") ? (device = "tablet", window.fp.device = "tablet") : Modernizr.mq("all and (min-width: 1024px)") && (device = "desktop", window.fp.device = "desktop")
}

function footerAccordion() {
    if(window.innerWidth <= 767) {
        $(".footer-tiles .accordion-toggle h5").on("click", function() {
            event.preventDefault(), $(this).toggleClass("shown")
        })
    }
}

function headerFooterRender() {

    var headerFooterPath = "/bin/getHeadernFooter";
    var currentPagePathHeader = window.location.pathname+"&requestFor=header";

    $.ajax({
        type: 'GET',

		 "url": window.location.protocol + "//" + window.location.host + headerFooterPath + "?currentPagePath=" + currentPagePathHeader,
       // url: "https://www.fisher-price.com/"+formLocale+"/header.html", 

     success: function(response){
         if(response !='') {
			$('#header-content').html(response);
        	getSearch(); 
        	searchautocomplete();
        	showNavigationMenu();

         }

  	}});
	var currentPagePathFooter = window.location.pathname+"&requestFor=footer";
     $.ajax({
        type: 'GET',

		 "url": window.location.protocol + "//" + window.location.host + headerFooterPath + "?currentPagePath=" + currentPagePathFooter,
       // url: "https://www.fisher-price.com/"+formLocale+"/header.html", 

     success: function(response){
         if(response !='') {
			$('#footer-content').html(response)
         }

  	}});

}


function showNavigationMenu() {
     if(window.innerWidth <= 767) {
      $("#main-top-header .navbar-header").on("click", function() {
		$('.primary-nav').fadeToggle(500, function () {
                    ($(this).is(':visible')) ? $('header').css('display','block'): $('header').css('display','none');
                    //($(this).is(':visible')) ? $('header').css('display','block'): $('header').css('display','none')
                });

          });
		 }
}

function getSearchString() {

     var formLocale=$("#formLocale").val();
    localInfo="/"+formLocale.replace("-","_");
	 var data = $('.input-search').val();
   /*if(localInfo.toLowerCase() !== "/en_us"){
        window.location.href = localInfo + "/search/index.html?Ntt=" + data;
    }
    else{
         window.location.href = window.fp.oneStore.searchPageURL + data;
    }*/
    if(localInfo.toLowerCase() !== "/en_us"){
            //window.location.href = localInfo + "/search/index.html?Ntt=" + data;
            window.location.href =  "https://www.fisher-price.com/"+localInfo+"/search/index.html?Ntt=" + data;
        }
        else{
             //window.location.href = window.fp.oneStore.searchPageURL + data;
            window.location.href =  "https://fisher-price.mattel.com/shop/SearchDisplay?categoryId=&storeId=10151&catalogId=10101&langId=-1&sType=SimpleSearch&searchTerm="+ data;
    }
}

function searchautocomplete() {
var formLocale=$("#formLocale").val();
    	localInfo="/"+formLocale.replace("-","_");

         if(localInfo.toLowerCase() == "/en_us") {
              $("#main-top-header .input-search,.search-result-wrapper .input-search").on('keyup keypress', function(e){
             if($('#main-top-header .input-search,.search-result-wrapper .input-search').length > 0)  {

                /* $('#main-top-header .input-search,.search-result-wrapper .input-search').typeahead({
				   hint: true,
                   highlight: true,
                   minLength: 2
                 },
                 {
                   name: 'autoComplete',
                   displayKey: 'q',
                   display: 'dq',
                   source: function (query, sync, async) {
                       
                           $.get("https://www.fisher-price.com/"+localInfo + '/Search/GetSearchSuggestions', { q: query }, function (data) {
                        
                               var $results = [];
                               data = JSON.parse(data);
                               if(data.response && data.response.suggestions)  {
                                   async(data.response.suggestions);
                               }
                               
                           });
                    },
                     
                     templates: {
                        suggestion: function(data){
                          return "<div onclick = \"searchPage('" + data.q + "')\">" + data.dq +  "</div>";
                        }
                      }
                 });*/
                 data = { "responseHeader": { "status": 0, "QTime": 1 }, "response": { "q": "bab", "suggestions": [ { "q": "baby", "dq": "baby" }, { "q": "baby swing", "dq": "baby swing" }, { "q": "baby stroller", "dq": "baby stroller" }, { "q": "baby bouncer", "dq": "baby bouncer" }, { "q": "baby doll", "dq": "baby doll" }, { "q": "baby crib", "dq": "baby crib" }, { "q": "baby toys", "dq": "baby toys" }, { "q": "barbie baby", "dq": "barbie baby" }, { "q": "fisher price baby swings", "dq": "fisher price baby swings" }, { "q": "baby gear", "dq": "baby gear" }, { "q": "baby doll stroller", "dq": "baby doll stroller" }, { "q": "baby rocker", "dq": "baby rocker" }, { "q": "baby dome", "dq": "baby dome" }, { "q": "baby carrier", "dq": "baby carrier" }, { "q": "baby monitor", "dq": "baby monitor" }, { "q": "baby bedding", "dq": "baby bedding" }, { "q": "baby bag", "dq": "baby bag" }, { "q": "baby bottle", "dq": "baby bottle" }, { "q": "baby books", "dq": "baby books" }, { "q": "baby dress", "dq": "baby dress" } ], "numFound": 21 } };
                               data = JSON.parse(data);
                               if(data.response && data.response.suggestions)  {
                                  alert(data.response.suggestions);
                          }
                  var inputval = $('.input-search').val();
					 $.ajax({
                        type: 'GET',
                         "url": "https://www.fisher-price.com"+localInfo + '/Search/GetSearchSuggestions?q='+inputval,
                       //  "url": window.location.protocol + "//" + window.location.host + headerFooterPath + "?currentPagePath=" + currentPagePathFooter,
                       // url: "https://www.fisher-price.com/"+formLocale+"/header.html", 
                
                     success: function(response){
                         if(response.responseHeader !='') {
                            $('.search-box').append('<div class="autoComplete"></div>');


                               if(data.response && data.response.suggestions)  {
                                 for(var i=0;i<=data.response.suggestions.length;i++) {
										$('.autoComplete').append("<div onclick = \'searchPage('" + data.response.suggestions[i].q + "')\">" + data.response.suggestions[i].dq +  "</div>");
                                  }
                          }
                         }
                
                    }});
                   }
                 });

	}
}

function getSearch() {

    $("#main-top-header .input-search,.search-result-wrapper .input-search").on('keyup keypress', function(e){

        var formLocale=$("#formLocale").val();
        localInfo="/"+formLocale.replace("-","_");
        if(e.which == 13) {        
            var data = $(this).val();
            //var localInfo = "en_us"; 
            if(localInfo.toLowerCase() !== "/en_us"){
                //window.location.href = localInfo + "/search/index.html?Ntt=" + data;
                window.location.href =  "https://www.fisher-price.com/"+localInfo+"/search/index.html?Ntt=" + data;
            }
            else{
                 //window.location.href = window.fp.oneStore.searchPageURL + data;
                window.location.href =  "https://fisher-price.mattel.com/shop/SearchDisplay?categoryId=&storeId=10151&catalogId=10101&langId=-1&sType=SimpleSearch&searchTerm="+ data;
            }
        }
    });

}


$(document).ready(function() {
          footerAccordion() , headerFooterRender() , showNavigationMenu(),  searchautocomplete() , getSearch()
});
