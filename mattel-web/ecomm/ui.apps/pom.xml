<?xml version="1.0" encoding="UTF-8"?>
<!-- | Copyright 2015 Adobe Systems Incorporated | | Licensed under the Apache 
	License, Version 2.0 (the "License"); | you may not use this file except 
	in compliance with the License. | You may obtain a copy of the License at 
	| | http://www.apache.org/licenses/LICENSE-2.0 | | Unless required by applicable 
	law or agreed to in writing, software | distributed under the License is 
	distributed on an "AS IS" BASIS, | WITHOUT WARRANTIES OR CONDITIONS OF ANY 
	KIND, either express or implied. | See the License for the specific language 
	governing permissions and | limitations under the License. -->
<project xmlns="http://maven.apache.org/POM/4.0.0"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
	<modelVersion>4.0.0</modelVersion>

	<!-- ====================================================================== -->
	<!-- P A R E N T P R O J E C T D E S C R I P T I O N -->
	<!-- ====================================================================== -->
	<parent>
		<groupId>com.mattel.ecomm</groupId>
		<artifactId>ecomm</artifactId>
		<version>1.0.39-SNAPSHOT</version>
		<relativePath>../pom.xml</relativePath>
	</parent>

	<!-- ====================================================================== -->
	<!-- P R O J E C T D E S C R I P T I O N -->
	<!-- ====================================================================== -->
	<artifactId>ecomm.ui.apps</artifactId>
	<packaging>content-package</packaging>
	<name>ecomm - UI apps</name>
	<description>UI apps package for ecomm</description>

	<!-- <scm> <connection></connection> <developerConnection></developerConnection> 
		<url></url> <tag>HEAD</tag> </scm -->

	<!-- ====================================================================== -->
	<!-- B U I L D D E F I N I T I O N -->
	<!-- ====================================================================== -->
	<build>
		<sourceDirectory>src/main/content/jcr_root</sourceDirectory>
		<resources>
			<!-- define the resources that will go into the package -->
			<resource>
				<directory>${basedir}/src/main/content/jcr_root</directory>
				<excludes>
					<!-- exclude .vlt control files in the package -->
					<exclude>**/.vlt</exclude>
					<exclude>**/.vltignore</exclude>
					<exclude>**/.gitignore</exclude>
					<exclude>**/*.iml</exclude>
					<exclude>**/.classpath</exclude>
					<exclude>**/.project</exclude>
					<exclude>**/.settings</exclude>
					<exclude>**/.DS_Store</exclude>
					<exclude>**/target/**</exclude>
					<exclude>**/pom.xml</exclude>
					<!-- exclude files generated from the frontend-maven-plugin and applied because of Babel integration -->
					<exclude>**/gulpfile.js</exclude>
					<exclude>**/package-lock.json</exclude>
					<exclude>**/package.json</exclude>
					<exclude>**/node/**</exclude>
					<exclude>**/node_modules/**</exclude>
					<exclude>**/babel/**</exclude>
					<!-- end of update for Babel integration -->
					<!-- exclude files generated from the frontend-maven-plugin and applied because of scss integration -->
					<exclude>**/sass/**</exclude>
					<exclude>/apps/mattel/ecomm/shared/components/content/bazaarVoice/js/lazyload.js</exclude>
					<!-- end of update for scss integration -->
				</excludes>
			</resource>
		</resources>
		<plugins>
			<!-- we want to keep some of the META-INF files and not configure everything 
				in the plugin (mainly the filters). copy the resource explicitly instead 
				of attaching it to the default resources -->
			<plugin>
				<artifactId>maven-resources-plugin</artifactId>
				<!-- ensure that the empty directories are copied -->
				<configuration>
					<includeEmptyDirs>true</includeEmptyDirs>
				</configuration>
			</plugin>
			<plugin>
                <groupId>com.learningobjects</groupId>
                <artifactId>sass-maven-plugin</artifactId>
                <version>1.1</version>
                <executions>
                    <execution>
                        <id>compile-sass</id>
                        <configuration>
                            <sassSourceDirectory>${basedir}/src/main/content/jcr_root/apps/mattel/ecomm/shared/</sassSourceDirectory>
                            <cssTargetDirectory>${basedir}/target/classes/apps/mattel/ecomm/shared/</cssTargetDirectory>
                        </configuration>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>

			<!-- ====================================================================== -->
			<!-- V A U L T P A C K A G E P L U G I N -->
			<!-- ====================================================================== -->
			<plugin>
				<groupId>com.day.jcr.vault</groupId>
				<artifactId>content-package-maven-plugin</artifactId>
				<extensions>true</extensions>
				<configuration>
					<filterSource>src/main/content/META-INF/vault/filter.xml</filterSource>
					<verbose>false</verbose>
					<failOnError>true</failOnError>
					<group>ecomm</group>
                    <archive>
                        <manifestEntries>
                            <Built-By>${user.name}</Built-By>
                            <Build-Time>${maven.build.timestamp}</Build-Time>
                            <Implementation-Vendor-Id>${project.groupId}</Implementation-Vendor-Id>
                        </manifestEntries>
                        <manifest>
                            <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
                            <addDefaultSpecificationEntries>true</addDefaultSpecificationEntries>
                        </manifest>
                    </archive>
					<embeddeds>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>ecomm.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>coreservice.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>registration.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>productinterest.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>login.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>orderhistory.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>shippingmodes.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>carddetails.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>agrewards.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>addressinfo.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>personalinfo.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>paymentInfo.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>contactPreferences.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
                        <embedded>
                            <groupId>com.mattel.ecomm</groupId>
                            <artifactId>dolls.core</artifactId>
                            <target>/apps/mattel/ecomm/shared/install</target>
                        </embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>productDetails.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>pdp.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>fedex.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
						<embedded>
							<groupId>com.mattel.ecomm</groupId>
							<artifactId>loyaltyRewards.core</artifactId>
							<target>/apps/mattel/ecomm/shared/install</target>
						</embedded>
					</embeddeds>
					<subPackages>
						<subPackage>
							<groupId>com.adobe.cq</groupId>
							<artifactId>core.wcm.components.all</artifactId>
							<filter>true</filter>
						</subPackage>
					</subPackages>
				</configuration>
			</plugin>
			
			<!-- ====================================================================== -->
            <!-- F R O N T E N D  M A V E N   P L U G I N                                -->
            <!-- ====================================================================== -->
			<plugin>
				<groupId>com.github.eirslett</groupId>
				<artifactId>frontend-maven-plugin</artifactId>
				<version>${frontend-maven-plugin.version}</version>			
				 <executions>
				   <execution>
						<id>install node and npm</id>
						<goals>
						<goal>install-node-and-npm</goal>
						</goals>
						<configuration>
							<nodeVersion>${node.version}</nodeVersion>
							<npmVersion>${npm.version}</npmVersion>
						</configuration>
					</execution>	 
					<execution>
						<id>npm install</id>
						<goals>
						<goal>npm</goal>
						</goals>
						<!-- Optional configuration which provides for running any npm command -->
						<configuration>
							<npmInheritsProxyConfigFromMaven>false</npmInheritsProxyConfigFromMaven>
							<arguments>install</arguments>
						</configuration>
					</execution>					
					<execution>
						 <id>gulp</id>
						 <goals>
							 <goal>gulp</goal>
						 </goals>
						 <phase>generate-resources</phase>
					</execution>
                    <execution>
                         <id>gulp-minify-css</id>
                         <goals>
                             <goal>gulp</goal>
                         </goals>
                          <configuration>
                            <!-- optional: if not specified, it will run gulp's default
                            task (and you can remove this whole <configuration> section.) -->
                            <arguments>styles</arguments>
                        </configuration>
                         <phase>process-resources</phase>
                    </execution>
				</executions>			
			</plugin>	

			<plugin>
				<groupId>org.apache.sling</groupId>
				<artifactId>htl-maven-plugin</artifactId>
			</plugin>

			<!-- ====================================================================== -->
            <!-- M I N I F Y  M A V E N   P L U G I N                                -->
            <!-- ====================================================================== -->
			<plugin>
				<groupId>com.samaxes.maven</groupId>
				<artifactId>minify-maven-plugin</artifactId>
				<version>1.7.6</version>
				<executions>
					<execution>
						<id>default-minify</id>
						<configuration>
							<webappSourceDir>${basedir}/target/classes/apps/mattel/ecomm/shared</webappSourceDir>
							<jsSourceDir>components/content</jsSourceDir>
							<webappTargetDir>${basedir}/target/classes/apps/mattel/ecomm/shared</webappTargetDir>
                            <jsTargetDir>components/content</jsTargetDir>
							<skipMerge>true</skipMerge>
							<jsSourceFiles>
								<jsSourceFile>brandnCategoryListing/brandnCategoryListing/brand-image-list.js</jsSourceFile>
								<jsSourceFile>downloadApp/clientlibs_DownloadApp/js/limitDowloadApp.js</jsSourceFile>
								<jsSourceFile>downloadApp/clientlibs-downloadApp/downloadApps.js</jsSourceFile>
								<jsSourceFile>emailPreferences/emailPreferences/js/email-pref.js</jsSourceFile>
								<jsSourceFile>pdp/clientLibs-pdp/js/fp-productInfo.js</jsSourceFile>
								<jsSourceFile>pdp/clientLibs-pdp/js/fp-scene7.js</jsSourceFile>
								<jsSourceFile>siteHeader/clientlib-siteHeader/fp-header.js</jsSourceFile>
								<jsSourceFile>siteNavigation/siteNavigation/js/search.js</jsSourceFile>
							</jsSourceFiles>
						</configuration>
						<goals>
							<goal>minify</goal>
						</goals>
					</execution>
					<execution>
                        <id>default-minify-2</id>
                        <configuration>
                            <webappSourceDir>${basedir}/src/main/content/jcr_root/apps/mattel/ecomm/shared</webappSourceDir>
                            <webappTargetDir>${project.build.directory}/classes/apps/mattel/ecomm/shared</webappTargetDir>
                            <skipMerge>true</skipMerge>
                            <nosuffix>true</nosuffix>
                            <jsSourceDir>.</jsSourceDir>
                            <jsSourceIncludes>
                                <jsSourceInclude>components/content/sharedSearch/v1/search/search-typeahead/typeahead/typeahead.bundle.js</jsSourceInclude>
				<jsSourceInclude>components/content/bazaarVoice/bazaarVoice/js/lazyload.js</jsSourceInclude>
                                <jsSourceInclude>clientlibs/ecomm-crm/js/cookie.js</jsSourceInclude>
                                <jsSourceInclude>clientlibs/ecomm-crm/js/initialize.js</jsSourceInclude>
                            </jsSourceIncludes>
                            <jsEngine>CLOSURE</jsEngine>
                        </configuration>
                        <goals>
                            <goal>minify</goal>
                        </goals>
                    </execution>
				</executions>
			</plugin>


		</plugins>
	</build>



	<!-- ====================================================================== -->
	<!-- D E P E N D E N C I E S -->
	<!-- ====================================================================== -->
	<dependencies>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>ecomm.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>coreservice.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>registration.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>login.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>productinterest.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>carddetails.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>agrewards.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>orderhistory.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>shippingmodes.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>personalinfo.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>addressinfo.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>paymentInfo.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>contactPreferences.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
			<scope>provided</scope>
		</dependency>
        <dependency>
            <groupId>com.mattel.ecomm</groupId>
            <artifactId>dolls.core</artifactId>
            <version>1.0.39-SNAPSHOT</version>
            <scope>provided</scope>
        </dependency>
		<dependency>
            <groupId>com.mattel.ecomm</groupId>
            <artifactId>productDetails.core</artifactId>
            <version>1.0.39-SNAPSHOT</version>
            <scope>provided</scope>
        </dependency>
         <dependency>
            <groupId>com.mattel.ecomm</groupId>
            <artifactId>pdp.core</artifactId>
            <version>1.0.39-SNAPSHOT</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>fedex.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
            <scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.mattel.ecomm</groupId>
			<artifactId>loyaltyRewards.core</artifactId>
			<version>1.0.39-SNAPSHOT</version>
            <scope>provided</scope>
		</dependency>  
		<dependency>
			<groupId>com.adobe.aem</groupId>
			<artifactId>uber-jar</artifactId>
			<classifier>apis</classifier>
		</dependency>

		<dependency>
			<groupId>com.adobe.cq</groupId>
			<artifactId>core.wcm.components.all</artifactId>
			<type>zip</type>
		</dependency>

		<dependency>
			<groupId>javax.jcr</groupId>
			<artifactId>jcr</artifactId>
		</dependency>

		<dependency>
			<groupId>javax.servlet</groupId>
			<artifactId>servlet-api</artifactId>
		</dependency>

		<dependency>
			<groupId>com.day.cq.wcm</groupId>
			<artifactId>cq-wcm-taglib</artifactId>
		</dependency>
	</dependencies>
</project>
